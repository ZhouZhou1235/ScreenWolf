# 宠物开发


## 概述
本文档指导如何为《屏幕有狼》桌面宠物游戏开发新的宠物扩展。宠物是一个独立的JAR包，包含代码、资源和配置文件。
mod/pet-demo是作者编写的基本示例，可以复制修改为自己的宠物。
PetPackager是作者准备的快速打包工具，宠物写好后将项目文件夹放到PetPackager/pet-projects中，然后运行。工具会自动完成打包，输出的jar包在output文件夹中。

## 项目结构
一个标准的宠物项目应包含以下结构：
```
pet-demo/
├── src/
│   └── main/
│       ├── java/
│       │   └── com/
│       │       └── pinkcandy/
│       │           └── pet_demo/
│       │               ├── Pet_Demo.java      // 宠物主类
│       │               └── Test.java          // 测试类
│       └── resources/
│           ├── META-INF/
│           │   └── pet_data.json              // 宠物元数据配置文件
│           └── assets/
│               └── animations/                // 动画帧目录
│                   ├── default/               // 默认待机动画
│                   │   ├── 0.png
│                   │   └── 1.png
│                   ├── move/                  // 移动动画
│                   ├── touch/                 // 抚摸动画
│                   ├── focus/                 // 聚焦动画
│                   ├── press/                 // 按压动画
│                   ├── rest/                  // 休息动画
│                   ├── special/               // 特殊动画（高好感度）
│                   └── sad/                   // 悲伤动画（低好感度）
├── pom.xml                                   // Maven项目配置文件
```


## 开发步骤

### 创建Maven项目
使用提供的 `pom.xml` 模板，修改字段：
```xml
<groupId>com.pinkcandy</groupId>
<artifactId>your-pet-name</artifactId>
<version>1.0.0</version>
<name>Your Pet Name</name>
```
**注意版本号应该与要使用的主程序一致**

### 创建宠物主类
继承 `PetBase` 类并实现基本结构：
```java
package com.pinkcandy.pet_demo;
import com.pinkcandy.screenwolf.Launcher;
import com.pinkcandy.screenwolf.base.PetBase;
// 桌宠示例
public class Pet_Demo extends PetBase {
    // 【必须】显式定义该构造方法，类名是宠物的唯一标识，应该避免冲突。
    public Pet_Demo(Launcher launcher){super(launcher);}
}
```

### 配置宠物元数据
创建 `src/main/resources/META-INF/pet_data.json`：
```json
{
    "name": "宠物显示名称",
    "jarName": "pet-demo-1.0.0.jar",
    "specialMessages": [],
    "sadMessages": []
}
```
### 准备动画资源
在 `src/main/resources/assets/animations/` 下创建动画目录：
**必须的动画**：`default/`, `move/`, `touch/`, `focus/`, `press/`, `rest/`,`special/`, `sad/`
**命名规范**：帧图片按顺序命名

### 编译打包
使用官方提供的桌宠Maven项目打包程序
见 PetPackager
或使用Maven命令自行编译项目
```bash
mvn clean package
```


## 测试与调试

### 方法一：使用测试类
创建测试类进行快速调试：
```java
public class Test {
    public static void main(String[] args) {
        Launcher launcher = new Launcher();
        PetBase pet = new YourPetName(launcher);
        launcher.testLoadPet(pet);
    }
}
```

### 方法二：直接放入游戏
1. 将编译好的JAR包复制到游戏的 `data/pets/` 目录
2. 启动游戏，在欢迎窗口中选择你的宠物加载
**注意**：由于资源加载机制，某些功能需要打包成JAR后才能正常工作。


## 部署与发布
### 1. 检查清单
- [ ] 宠物类继承自 `PetBase`
- [ ] 包含正确的构造方法
- [ ] `pet_data.json` 配置正确
- [ ] 动画帧完整
- [ ] JAR包命名与配置一致
### 2. 安装方法
将最终的JAR文件放入主程序的 `data/pets/` 目录即可。
### 3. 分享宠物
将制作好的宠物JAR包分享给其他玩家，只需将其放入自己的 `data/pets/` 目录就能使用。
